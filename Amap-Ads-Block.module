#!name=高德地图去广告（Surge）
#!desc=由 QX 规则改写，MITM *.amap.com，全量去广告
#!author=RuCu6, kokoryh, 树先生（Surge 适配）

[MITM]
hostname = %APPEND% *.amap.com

[Script]
# 路线规划推广
amap_route_beforeNavi = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/aos\/perception\/publicTravel\/beforeNavi\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 路线规划和导航结束页推广
amap_bus_plan_integrate = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/bus\/plan\/integrate\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 导航详情页底部酒店
amap_hotel_launch_page = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/c3frontend\/af-(hotel|launch)\/page\/main\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 路线规划推广（drive）
amap_drive_route = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/perception\/drive\/(routeInfo|routePlan),requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 搜索地点导航详情页推广
amap_poi_detail_coupon = type=http-response,pattern=^https:\/\/(?:info\.amap\.com|m5\.amap\.com)\/ws\/shield\/search\/(common\/coupon\/info|poi\/detail),requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 搜索框提示词
amap_search_hotword = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_bff\/hotword\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 搜索详情页推广
amap_search_homepage = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/homepage,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# PS: 会影响搜索地点后不会自动定位到此地点
amap_search_sp = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/search\/sp,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

amap_search_sug = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/sug,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

amap_search_tips_op = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/tips_operation_location,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 首页推广
amap_home_card_main = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/faas\/amap-navigation\/(card-service-plan-home|main-page),requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# frogserver aocs 配置广告（原 QX Body Rewrite 同类功能，已由 js 规则处理）
amap_aocs_updatable_1 = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/frogserver\/aocs\/updatable\/1\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 我的页面推广
amap_profile_index = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/dsp\/profile\/index\/nodefaasv3\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 附近页推广
amap_nearby_rec = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search\/nearbyrec_smart\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 附近页横幅广告、信息流广告
amap_nearby_feed = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/c3frontend\/af-nearby\/nearby,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 开屏广告
amap_splash = type=http-response,pattern=^https:\/\/m5\.amap\.com\/ws\/valueadded\/alimama\/splash_screen\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 打车页(红点角标,弹窗,天气图标,推广卡片)
amap_taxi_content_info = type=http-response,pattern=^https:\/\/m5-zb\.amap\.com\/ws\/boss\/(car\/order\/content_info|order_web\/friendly_information),requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 打车页红点角标、天气图标
amap_taxi_promotion_resource = type=http-response,pattern=^https:\/\/m5-zb\.amap\.com\/ws\/promotion-web\/resource(\/home)?\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

amap_taxi_order_detail_tips = type=http-response,pattern=^https:\/\/m5-zb\.amap\.com\/ws\/sharedtrip\/taxi\/order_detail_car_tips\?,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863,timeout=60

# 阿里平台广告
amap_amdc_header = type=http-response,pattern=^http:\/\/amdc\.m\.taobao\.com\/amdc\/mobileDispatch,requires-body=1,max-size=0,script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/header.js?token=209863,timeout=60


[Map Local]
# 此条可以屏蔽首次进入的天气动效图层  但是会导致足迹不显示地图数据
^https:\/\/mps\.amap\.com\/ws\/mps\/scene\?  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 线路导航火车tab推荐
^https:\/\/m5\.amap\.com\/ws\/boss\/transportation\/diversion\/car_train_all_car  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 订单页更多服务提示
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/feedback\/viptips  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 订单页打车服务评价
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/remark\/satisfactionConf  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 订单页随机提问服务反馈问题
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/feedback\/get_card_questions  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 订单页开始支付宝支付提示横幅
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/pay\/web\/paySuccess\/info\/request  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/faas\/amap-navigation\/card-service-(car-end|route-plan)  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/tips_adv\?  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/oss\.amap\.com\/ws\/banner\/lists\/\?  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/aos\/main\/page\/product\/list\?  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/faas\/amap-navigation\/(main-page-assets|main-page-location|ridewalk-end-fc)  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 搜索框热词 / 通知
^https:\/\/m5\.amap\.com\/ws\/(mapapi\/hint_text\/offline_data|message\/notice\/list|shield\/search\/new_hotword)  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/shield\/scene\/recommend\?  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 左下角天气
^https:\/\/m5\.amap\.com\/ws\/valueadded\/weather\/v2\?  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/sns\.amap\.com\/ws\/msgbox\/pull_mp\?  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

^https:\/\/m5-zb\.amap\.com\/ws\/boss\/(order\/car\/king_toolbox_car_bubble|tips\/onscene_visual_optimization)  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 搜索结果地图左下角广告图标
^https:\/\/m5\.amap\.com\/ws\/shield\/search_business\/process\/marketingOperationStructured  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 订单页司机信息栏底部无忧行广告
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/rights_information  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 导航打车tab去除顺风车推荐
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/transportation\/diversion\/resource\/driving  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 首页底部 ai（如果有下一条规则，那本条规则不会触发）
^https:\/\/ai\.amap\.com\/v1\/ai_rec\/  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 新的开屏广告
^https:\/\/amap-aos-info-nogw\.amap\.com\/ws\/aos\/alimama\/splash_screen_rt  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"

# 高德打车广告
^https:\/\/m5-zb\.amap\.com\/ws\/fluorite\/resource  data-type=text  data="{}"  status-code=200  header="Content-Type:application/json"
